<div class="mx-auto px-4 py-8">
  <%= render DataTableComponent.new(
    title: t('users.index.title'),
    filters: @filters,
    active_filter_keys: @active_filter_keys,
    columns: [
      { 
        key: :email_address, 
        label: t('users.columns.email'), 
        sortable: true,
        priority: :high,
        truncate: true
      },
      {
        key: :status,
        label: t('users.columns.status'),
        sortable: false, # Custom sorting handled by controller
        priority: :high,
        format: ->(user) { auto_status_badge(user.status) }
      },
      {
        key: :created_at,
        label: t('users.columns.created_at'),
        type: :datetime,
        sortable: true,
        priority: :normal
      },
      {
        key: :updated_at,
        label: t('users.columns.updated_at'),
        type: :datetime,
        sortable: true,
        priority: :low
      }
    ],
    data: @users,
    pagy: @pagy,
    sort_column: params[:sort],
    sort_direction: params[:direction],
    current_filters: params.except(:controller, :action, :sort, :direction, :page, :limit).permit!.to_h,
    empty_message: t('table.empty_message'),
    selectable: true,
    selected_ids: params[:selected_ids] || [],
    row_actions: [
      {
        label: t('common.actions.view'),
        icon: "eye",
        url: ->(user) { user_path(user) },
        type: :link
      },
      {
        label: t('common.actions.edit'),
        icon: "pencil",
        url: ->(user) { edit_user_path(user) },
        type: :link
      },
      {
        label: t('common.actions.delete'),
        icon: "trash-2",
        url: ->(user) { user_path(user) },
        type: :button,
        method: :delete,
        data: { turbo_confirm: t('common.actions.confirm') }
      }
    ],
    action_buttons: []
  ) %>
